document.addEventListener("DOMContentLoaded",function(){var e=document.querySelector("#quote_productType");let t=document.querySelector("#otherProductTypeContainer");var r=document.querySelector("#quoteForm");let o=document.querySelector("#loader");function p(e){if(e){var r=e.closest(".photo-upload-container");if(r){let t=r.querySelector(".product-photo-preview");t&&e.addEventListener("change",function(){var e;this.files&&this.files[0]?((e=new FileReader).onload=function(e){t.src=e.target.result,t.style.display="block"},e.readAsDataURL(this.files[0])):(t.src="#",t.style.display="none")})}}}e&&t&&("other"===e.value?(t.style.display="block",(l=t.querySelector("input"))&&(l.required=!0)):(t.style.display="none",(l=t.querySelector("input"))&&(l.required=!1)),e.addEventListener("change",function(){var e;"other"===this.value?(t.style.display="block",(e=t.querySelector("input"))&&(e.required=!0)):(t.style.display="none",(e=t.querySelector("input"))&&(e.required=!1))})),document.addEventListener("change",function(e){var t;e.target&&e.target.classList.contains("product-type-select")&&(t=e.target.closest(".quote-item"))&&(t=t.querySelector(".other-product-type-container"))&&("Autre"===e.target.value?(t.style.display="block",(e=t.querySelector("input"))&&(e.required=!0)):(t.style.display="none",(e=t.querySelector("input"))&&(e.required=!1)))}),document.querySelectorAll(".form-control-file").forEach(function(e){p(e)}),document.addEventListener("change",function(e){if(e.target&&"file"===e.target.type&&e.target.classList.contains("form-control-file")){var r=e.target.closest(".photo-upload-container");if(r){let t=r.querySelector(".product-photo-preview");t&&(e.target.files&&e.target.files[0]?((r=new FileReader).onload=function(e){t.src=e.target.result,t.style.display="block"},r.readAsDataURL(e.target.files[0])):(t.src="#",t.style.display="none"))}}});var l=document.querySelector(".add-item-btn");let m=document.querySelector(".quote-items-wrapper");l&&m&&l.addEventListener("click",function(){var e=document.querySelectorAll(".quote-item");if(0<e.length){let o=e[0].cloneNode(!0),l=parseInt(m.dataset.index);o.querySelectorAll("input, select, textarea").forEach(function(e){var r=e.id,t=e.name;if(r){let t=r.replace(/\d+/,l);e.id=t,o.querySelectorAll(`label[for="${r}"]`).forEach(function(e){e.setAttribute("for",t)})}t&&(r=t.replace(/\[\d+\]/,`[${l}]`),e.name=r),"file"!==e.type&&("select-one"===e.type?e.selectedIndex=0:e.value="")});o.querySelectorAll("div[id]").forEach(function(e){var t=e.id;t&&(t=t.replace(/\d+/,l),e.id=t)});var e=o.querySelector(".product-photo-preview"),e=(e&&(e.src="#",e.style.display="none"),o.querySelector(".other-product-type-container")),e=(e&&(e.style.display="none",e=e.querySelector("input"))&&(e.required=!1),m.appendChild(o),o.querySelector(".form-control-file"));e&&p(e),m.dataset.index=l+1}else{var t,r,o,e=m.dataset.prototype,l=parseInt(m.dataset.index),e=e.replace(/__name__/g,l),a=document.createElement("div"),n=(a.classList.add("quote-item"),a.innerHTML=`
                    <span class="remove-item"><i class="fas fa-times-circle"></i></span>
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <div class="photo-container">
                                <div class="photo-upload-container">
                                    <!-- Le contenu sera ajouté dynamiquement -->
                                </div>
                            </div>
                        </div>
                        <div class="col-md-8">
                            <div class="row">
                                <!-- Le contenu sera ajouté dynamiquement -->
                            </div>
                        </div>
                    </div>
                `,m.appendChild(a),document.createElement("div")),e=(n.innerHTML=e,n.querySelector('div[id$="_photoFile"]')),d=n.querySelector('div[id$="_productType"]'),i=n.querySelector('div[id$="_quantity"]'),c=n.querySelector('div[id$="_budget"]'),s=n.querySelector('div[id$="_otherProductType"]'),n=n.querySelector('div[id$="_description"]'),u=(e&&(r=a.querySelector(".photo-upload-container"))&&(e=e.querySelector('input[type="file"]'))&&(e.className="form-control-file d-none",(t=document.createElement("label")).setAttribute("for",e.id),t.className="upload-label",(o=document.createElement("div")).className="photo-upload-icon",o.innerHTML='<i class="fas fa-camera"></i>',(u=document.createElement("span")).textContent="Cliquez pour ajouter une photo",t.appendChild(o),t.appendChild(u),(o=document.createElement("img")).src="#",o.className="product-photo-preview",o.alt="Aperçu de la photo",r.appendChild(t),r.appendChild(e),r.appendChild(o),p(e)),a.querySelector(".col-md-8 .row"));u&&(d&&((t=document.createElement("div")).className="col-md-4 mb-3",t.appendChild(d),u.appendChild(t)),i&&((r=document.createElement("div")).className="col-md-4 mb-3",r.appendChild(i),u.appendChild(r)),c&&((o=document.createElement("div")).className="col-md-4 mb-3",o.appendChild(c),u.appendChild(o)),s&&((e=document.createElement("div")).className="col-12 mb-3 other-product-type-container",e.style.display="none",e.appendChild(s),u.appendChild(e)),n)&&((a=document.createElement("div")).className="col-12 mb-3",a.appendChild(n),u.appendChild(a)),m.dataset.index=l+1}}),document.addEventListener("click",function(e){e.target&&(e.target.classList.contains("remove-item")||e.target.closest(".remove-item"))&&(e=e.target.closest(".quote-item"))&&e.remove()}),r&&r.addEventListener("submit",function(){var e=document.querySelector("#submitButton");e&&(e.disabled=!0),o&&(o.style.display="flex")})});